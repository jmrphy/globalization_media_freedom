data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + lopenk2+ scode + year,
model = "logit",
by="dem",
data=zvars.trade.mnom)
summary(repress.model)
summary(repress.model)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + lopenk2+ scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + lopenk2+ scode + year,
model = "relogit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + lopenk2+ scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
View(zvars.trade.mnom)
require(Zelig)
require(splines)
require(ggplot2)
modelvars<-read.csv("~/Dropbox/gh_projects/globalization_media_freedom/data/out_modelvars.csv")
df<-read.csv("~/Dropbox/gh_projects/globalization_media_freedom/data/out_df.csv")
df$fp<-as.factor(df$fp)
View(df)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + lopenk2 + scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + lopenk2 +oil + internet + ethfrac + relfrac + onset + warl+ scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + lopenk2 + oil + internet + ethfrac + relfrac + warl + scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + lopenk2 +  internet + ethfrac + relfrac + onset + warl + scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + lopenk2 + oil + internet + warl + scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ lmedia + dopenk2 + oil + internet + warl + scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ dopenk2 + oil + internet + warl + scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ dopenk2 + lopenk2 + oil + internet + warl + scode + year,
model = "logit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(mediadown ~ dopenk2 + lopenk2 + oil + internet + warl + scode + year,
model = "relogit",
data=zvars.trade.mnom)
summary(repress.model)
repress.model <- zelig(dmedia ~ lmedia + dopenk2 + lopenk2 + scode + year,
model = "ls",
data=zvars.trade.mnom)
summary(repress.model)
mnom.model <- zelig(as.factor(mediascore) ~ lpolity2 + lrgdpch2 + lopenk2 + oil + internet + ethfrac + relfrac + onset + warl,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
summary(mnom.model)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + dopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
quantile(zvars.trade$lopenk, .25)
x.weak <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .25))
x.lo.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .25))
x.hi.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .75))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
x.lo.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .25))
x.hi.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .75))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
??Zeligchoice
install.packages("Zelig")
install.packages("Zelig")
install.packages("Zelig")
devtools::install_github("IQSS/ZeligChoice")
library("Zelig", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
library("ZeligChoice", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
x.lo.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .25))
x.hi.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .75))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
plot(s.out.mlogit)
x.lo.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .1))
x.hi.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .9))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
plot(s.out.mlogit)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
x.lo.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .1))
x.hi.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .9))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
plot(s.out.mlogit)
quantile(zvars.trade$lopenk, .1)
quantile(zvars.trade$lopenk, .9)
x.lo.trade <- setx(mnom.model, lopenk = min(zvars.trade$lopenk))
x.hi.trade <- setx(mnom.model, lopenk = max(zvars.trade$lopenk))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
plot(s.out.mlogit)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + dopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
x.lo.trade <- setx(mnom.model, lopenk = min(zvars.trade$lopenk))
x.hi.trade <- setx(mnom.model, lopenk = max(zvars.trade$lopenk))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
plot(s.out.mlogit)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + dopenk2 + lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
x.lo.trade <- setx(mnom.model, lopenk = min(zvars.trade$lopenk))
x.hi.trade <- setx(mnom.model, lopenk = max(zvars.trade$lopenk))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
plot(s.out.mlogit)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + lpolity2 + lrgdpch2  + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
x.lo.trade <- setx(mnom.model, lopenk = min(zvars.trade$lopenk))
x.hi.trade <- setx(mnom.model, lopenk = max(zvars.trade$lopenk))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
plot(s.out.mlogit)
max(zvars.trade.mnom$lopenk)
min(zvars.trade$lopenk)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + lpolity2 + lrgdpch2  + scode + year,
model = "mlogit", data = zvars.trade.mnom)
summary(mnom.model)
x.lo.trade <- setx(mnom.model, lopenk = 0)
x.hi.trade <- setx(mnom.model, lopenk = 6)
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
plot(s.out.mlogit)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + dopenk2 + lpolity2 + lrgdpch2  + scode + year,
model = "mlogit", data = zvars.trade.mnom)
summary(mnom.model)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + dopenk2 + lpolity2 + lrgdpch2  + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
View(zvars.trade)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + dopenk2 + lpolity2 + lrgdpch2  + scode + year,
model = "mlogit", data = zvars.trade)
require(plm)
zvars.trade.mnom<-pdata.frame(zvars.trade, index=c("scode", "year"))
zvars.trade.mnom$lmedia<-lag(zvars.trade.mnom$mediascore)
zvars.trade.mnom$dmedia<-diff(zvars.trade.mnom$mediascore)
zvars.trade.mnom$mediadown <- ifelse(zvars.trade.mnom$dmedia<0, 1, 0)
zvars.trade.mnom <- as.data.frame(zvars.trade.mnom)
repress.model <- zelig(dmedia ~ lmedia + dopenk2 + lopenk2 + scode + year,
model = "ls",
data=zvars.trade.mnom)
summary(repress.model)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
x.lo.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .25))
x.hi.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .75))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
plot(s.out)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
require(Zelig)
require(splines)
require(ggplot2)
modelvars<-read.csv("~/Dropbox/gh_projects/globalization_media_freedom/data/out_modelvars.csv")
df<-read.csv("~/Dropbox/gh_projects/globalization_media_freedom/data/out_df.csv")
df$fp<-as.factor(df$fp)
controls<-subset(modelvars, select=c("fp", "scode", "year", "lpolity2", "dpolity2", "lrgdpch", "lrgdpch2", "drgdpch","drgdpch2", "lopenk2", "dopenk2", "lfdiinward2", "dfdiinward2", "oil", "internet", "ethfrac", "relfrac", "warl", "onset"))
modelvars<-subset(modelvars, select=c("fp", "scode", "year", "lpolity2", "dpolity2", "lrgdpch", "lrgdpch2", "drgdpch","drgdpch2", "lopenk", "dopenk", "lopenk2", "dopenk2", "lfdiinward", "lfdiinward2", "dfdiinward","dfdiinward2", "lfpistock", "lfpistock2", "dfpistock", "dfpistock2", "oil", "internet", "ethfrac", "relfrac", "warl", "onset"))
#modelvars<-modelvars[complete.cases(modelvars),]
spline<-ns(1960:2011, df=3)
spline<-as.data.frame(spline)
names(spline)<-c("spline1", "spline2", "spline3")
spline$year<-1960:2011
modelvars<-merge(modelvars, spline, by="year")
modelvars<-modelvars[with(modelvars, order(scode, year)), ]
df<-subset(df, select=c("fp", "lfp", "fp.d", "mediascore", "scode", "year", "polity2", "lpolity2", "dpolity2", "lrgdpch", "lrgdpch2", "drgdpch","drgdpch2", "lopenk", "dopenk", "openk2", "lopenk2", "dopenk2", "lfdiinward", "lfdiinward2", "dfdiinward","dfdiinward2", "lfpistock", "lfpistock2", "dfpistock", "dfpistock2", "oil", "internet", "ethfrac", "relfrac", "warl", "onset"))
#df<-df[complete.cases(df),]
controls<-merge(controls, spline, by="year")
controls<-controls[with(controls, order(scode, year)), ]
df<-merge(df, spline, by="year")
df<-df[with(df, order(scode, year)), ]
### This is where I left off
### Model 1, Baseline ###
model1vars<-subset(modelvars, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lopenk2", "dopenk2"))
model1vars<-model1vars[complete.cases(model1vars),]
model1<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3,
model="logit",
data=model1vars,
cite=F)
model1classif<-table(unlist(model1$getfitted())>.5, model1vars$fp)
model1correct<-(model1classif[1,1] + model1classif[2,2])
(model1correct/nrow(model1vars))*100
#summary(model1)
model2vars<-subset(modelvars, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lopenk2", "dopenk2"))
model2vars<-model2vars[complete.cases(model2vars),]
model2<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lopenk2 + dopenk2,
model="logit",
data=model2vars,
cite=F)
model2classif<-table(unlist(model2$getfitted())>.5, model2vars$fp)
model2correct<-(model2classif[1,1] + model2classif[2,2])
(model2correct/nrow(model2vars))*100
summary(model2)
model3vars<-subset(modelvars, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lfdiinward2", "dfdiinward2"))
model3vars<-model3vars[complete.cases(model3vars),]
model3<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lfdiinward2 + dfdiinward2,
model="logit",
data=model3vars,
cite=F)
model3classif<-table(unlist(model3$getfitted())>.5, model3vars$fp)
model3correct<-(model3classif[1,1] + model3classif[2,2])
(model3correct/nrow(model3vars))*100
summary(model3)
model4vars<-subset(modelvars, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lfpistock2", "dfpistock2"))
model4vars<-model4vars[complete.cases(model4vars),]
model4<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lfpistock2 + dfpistock2,
model="logit",
data=model4vars,
cite=F)
model4classif<-table(unlist(model4$getfitted())>.5, model4vars$fp)
model4correct<-(model4classif[1,1] + model4classif[2,2])
(model4correct/nrow(model4vars))*100
summary(model4)
controls<-controls[complete.cases(controls),]
z.out.controls<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lopenk2 + dopenk2 + lfdiinward2 + dfdiinward2 + oil + internet + ethfrac + relfrac + onset + warl,
model="logit",
data=controls,
cite=F)
#plot(z.out.controls)
iv.corrs<-mean(abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$warl)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$onset)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$relfrac)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$ethfrac)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$internet)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$oil)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dfdiinward2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lfdiinward2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dopenk2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline3)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline1)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lopenk2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lpolity2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dpolity2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lrgdpch2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$drgdpch2))
)
iv.corrs.max<-max(abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$warl)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$onset)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$relfrac)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$ethfrac)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$internet)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$oil)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dfdiinward2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lfdiinward2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dopenk2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline3)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline1)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lopenk2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lpolity2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dpolity2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lrgdpch2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$drgdpch2))
)
z.out.controlsclassif<-(table(unlist(z.out.controls$getfitted())>.5, controls$fp))
z.out.controlscorrect<-(z.out.controlsclassif[1,1] + z.out.controlsclassif[2,2])
(z.out.controlscorrect/nrow(controls))*100
summary(z.out.controls)
z.out.controlsfpi<-subset(modelvars, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lopenk2", "dopenk2", "lfdiinward2", "dfdiinward2", "lfpistock2", "dfpistock2", "oil", "internet", "ethfrac", "relfrac", "onset", "warl"))
z.out.controlsfpi<-z.out.controlsfpi[complete.cases(z.out.controlsfpi),]
z.out.controls.fpi<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lopenk2 + dopenk2 + lfdiinward2 + dfdiinward2 + lfpistock2  + dfpistock2 + oil + internet + ethfrac + relfrac + onset + warl,
model="logit",
data=z.out.controlsfpi,
cite=F)
zvars.trade<-subset(df, select=c("scode", "year", "fp", "mediascore", "lfp", "fp.d", "polity2", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "openk2", "lopenk2", "dopenk2", "oil", "internet", "ethfrac", "relfrac", "warl", "onset"))
zvars.trade<-zvars.trade[complete.cases(zvars.trade),]
# In first submission with old zelig
# z.out.trade<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lopenk2 + dopenk2 + oil + internet + ethfrac + relfrac + onset + warl,
#               model="logit",
#               data=zvars.trade)
#trade.r<-seq(min(zvars.trade$lopenk2),max(zvars.trade$lopenk2), 1) # ~ min to max in sample
# For resubmission with new zelig
z.out.trade <- zlogit$new()
z.out.trade$zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lopenk2 + dopenk2 + oil + internet + ethfrac + relfrac + onset + warl,
data=zvars.trade)
zvars<-subset(df, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lopenk2", "dopenk2", "lfdiinward2", "dfdiinward2", "lfpistock2", "dfpistock2", "scode", "year", "oil", "internet", "ethfrac", "relfrac", "warl", "onset"))
zvars<-zvars[complete.cases(zvars),]
z.out<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lopenk2 + dopenk2 + lfdiinward2 + dfdiinward2 + lfpistock2  + dfpistock2 + oil + internet + ethfrac + relfrac + onset + warl,
model="logit",
data=zvars,
cite=F)
reverse.cause<-subset(df, select=c("lfp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "openk2", "lopenk2", "scode", "year"))
reverse.cause<-reverse.cause[complete.cases(reverse.cause),]
z.out.reverse1<-zelig(openk2 ~ lfp + as.factor(scode) + as.factor(year),
model="ls",
data=reverse.cause,
cite=F)
z.out.reverse2<-zelig(openk2 ~ lfp +  lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + as.factor(scode) + as.factor(year),
model="ls",
data=reverse.cause,
cite=F)
z.out.reverse3<-zelig(openk2 ~ lfp + lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + lopenk2 + as.factor(scode) + as.factor(year),
model="ls",
data=reverse.cause,
cite=F)
require(mediation)
require(ZeligChoice)
# Guarding against post-treatment; are countries like China skewing; request to interact open*dem and wealthy dems as exception
zvars.trade$dem <- ifelse(zvars.trade$polity2>quantile(zvars.trade$polity2, .5), "Democracy", "Non-Democracy")
zvars.trade$rich <- ifelse(zvars.trade$lrgdpch2>quantile(zvars.trade$lrgdpch2, .5), "Wealthy", "Non-Wealthy")
zvars.trade$dem <- cut(zvars.trade$polity2, 3)
by.dem.model <- zelig(fp ~ lopenk2,
model = "logit",
by="dem",
data=zvars.trade)
interact.model <- zelig(fp ~ lopenk2*lpolity2,
model = "logit",
by=
data=zvars.trade)
require(plm)
zvars.trade.mnom<-pdata.frame(zvars.trade, index=c("scode", "year"))
zvars.trade.mnom$lmedia<-lag(zvars.trade.mnom$mediascore)
zvars.trade.mnom$dmedia<-diff(zvars.trade.mnom$mediascore)
zvars.trade.mnom$mediadown <- ifelse(zvars.trade.mnom$dmedia<0, 1, 0)
zvars.trade.mnom <- as.data.frame(zvars.trade.mnom)
repress.model <- zelig(dmedia ~ lmedia + dopenk2 + lopenk2 + scode + year,
model = "ls",
data=zvars.trade.mnom)
summary(repress.model)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
x.lo.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .25))
x.hi.trade <- setx(mnom.model, lopenk = quantile(zvars.trade$lopenk, .75))
s.out.mlogit <- sim(mnom.model, x = x.lo.trade, x1 = x.hi.trade)
summary(s.out.mlogit)
plot(s.out)
View(zvars.trade)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2 + scode + year,
model = "mlogit", data = zvars.trade.mnom)
mnom.model <- zelig(as.factor(mediascore) ~ lopenk2,
model = "mlogit", data = zvars.trade.mnom)
zvars.trade$mediascore<-as.factor(zvars.trade$mediascore)
mnom.model <- zelig(mediascore ~ lopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
require(mediation)
require(ZeligChoice)
require(Zelig)
require(splines)
require(ggplot2)
modelvars<-read.csv("~/Dropbox/gh_projects/globalization_media_freedom/data/out_modelvars.csv")
df<-read.csv("~/Dropbox/gh_projects/globalization_media_freedom/data/out_df.csv")
df$fp<-as.factor(df$fp)
controls<-subset(modelvars, select=c("fp", "scode", "year", "lpolity2", "dpolity2", "lrgdpch", "lrgdpch2", "drgdpch","drgdpch2", "lopenk2", "dopenk2", "lfdiinward2", "dfdiinward2", "oil", "internet", "ethfrac", "relfrac", "warl", "onset"))
modelvars<-subset(modelvars, select=c("fp", "scode", "year", "lpolity2", "dpolity2", "lrgdpch", "lrgdpch2", "drgdpch","drgdpch2", "lopenk", "dopenk", "lopenk2", "dopenk2", "lfdiinward", "lfdiinward2", "dfdiinward","dfdiinward2", "lfpistock", "lfpistock2", "dfpistock", "dfpistock2", "oil", "internet", "ethfrac", "relfrac", "warl", "onset"))
#modelvars<-modelvars[complete.cases(modelvars),]
spline<-ns(1960:2011, df=3)
spline<-as.data.frame(spline)
names(spline)<-c("spline1", "spline2", "spline3")
spline$year<-1960:2011
modelvars<-merge(modelvars, spline, by="year")
modelvars<-modelvars[with(modelvars, order(scode, year)), ]
df<-subset(df, select=c("fp", "lfp", "fp.d", "mediascore", "scode", "year", "polity2", "lpolity2", "dpolity2", "lrgdpch", "lrgdpch2", "drgdpch","drgdpch2", "lopenk", "dopenk", "openk2", "lopenk2", "dopenk2", "lfdiinward", "lfdiinward2", "dfdiinward","dfdiinward2", "lfpistock", "lfpistock2", "dfpistock", "dfpistock2", "oil", "internet", "ethfrac", "relfrac", "warl", "onset"))
#df<-df[complete.cases(df),]
controls<-merge(controls, spline, by="year")
controls<-controls[with(controls, order(scode, year)), ]
df<-merge(df, spline, by="year")
df<-df[with(df, order(scode, year)), ]
### This is where I left off
### Model 1, Baseline ###
model1vars<-subset(modelvars, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lopenk2", "dopenk2"))
model1vars<-model1vars[complete.cases(model1vars),]
model1<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3,
model="logit",
data=model1vars,
cite=F)
model1classif<-table(unlist(model1$getfitted())>.5, model1vars$fp)
model1correct<-(model1classif[1,1] + model1classif[2,2])
(model1correct/nrow(model1vars))*100
#summary(model1)
model2vars<-subset(modelvars, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lopenk2", "dopenk2"))
model2vars<-model2vars[complete.cases(model2vars),]
model2<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lopenk2 + dopenk2,
model="logit",
data=model2vars,
cite=F)
model2classif<-table(unlist(model2$getfitted())>.5, model2vars$fp)
model2correct<-(model2classif[1,1] + model2classif[2,2])
(model2correct/nrow(model2vars))*100
summary(model2)
model3vars<-subset(modelvars, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lfdiinward2", "dfdiinward2"))
model3vars<-model3vars[complete.cases(model3vars),]
model3<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lfdiinward2 + dfdiinward2,
model="logit",
data=model3vars,
cite=F)
model3classif<-table(unlist(model3$getfitted())>.5, model3vars$fp)
model3correct<-(model3classif[1,1] + model3classif[2,2])
(model3correct/nrow(model3vars))*100
summary(model3)
model4vars<-subset(modelvars, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lfpistock2", "dfpistock2"))
model4vars<-model4vars[complete.cases(model4vars),]
model4<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lfpistock2 + dfpistock2,
model="logit",
data=model4vars,
cite=F)
model4classif<-table(unlist(model4$getfitted())>.5, model4vars$fp)
model4correct<-(model4classif[1,1] + model4classif[2,2])
(model4correct/nrow(model4vars))*100
summary(model4)
controls<-controls[complete.cases(controls),]
z.out.controls<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lopenk2 + dopenk2 + lfdiinward2 + dfdiinward2 + oil + internet + ethfrac + relfrac + onset + warl,
model="logit",
data=controls,
cite=F)
#plot(z.out.controls)
iv.corrs<-mean(abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$warl)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$onset)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$relfrac)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$ethfrac)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$internet)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$oil)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dfdiinward2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lfdiinward2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dopenk2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline3)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline1)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lopenk2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lpolity2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dpolity2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lrgdpch2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$drgdpch2))
)
iv.corrs.max<-max(abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$warl)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$onset)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$relfrac)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$ethfrac)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$internet)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$oil)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dfdiinward2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lfdiinward2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dopenk2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline3)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$spline1)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lopenk2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lpolity2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$dpolity2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$lrgdpch2)),
abs(cor(unlist(z.out.controls$getfitted()) - controls$fp, controls$drgdpch2))
)
z.out.controlsclassif<-(table(unlist(z.out.controls$getfitted())>.5, controls$fp))
z.out.controlscorrect<-(z.out.controlsclassif[1,1] + z.out.controlsclassif[2,2])
(z.out.controlscorrect/nrow(controls))*100
summary(z.out.controls)
z.out.controlsfpi<-subset(modelvars, select=c("fp", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "lopenk2", "dopenk2", "lfdiinward2", "dfdiinward2", "lfpistock2", "dfpistock2", "oil", "internet", "ethfrac", "relfrac", "onset", "warl"))
z.out.controlsfpi<-z.out.controlsfpi[complete.cases(z.out.controlsfpi),]
z.out.controls.fpi<-zelig(fp ~ lpolity2 + dpolity2 + lrgdpch2 + drgdpch2 + spline1 + spline2 + spline3 + lopenk2 + dopenk2 + lfdiinward2 + dfdiinward2 + lfpistock2  + dfpistock2 + oil + internet + ethfrac + relfrac + onset + warl,
model="logit",
data=z.out.controlsfpi,
cite=F)
zvars.trade<-subset(df, select=c("scode", "year", "fp", "mediascore", "lfp", "fp.d", "polity2", "lpolity2", "dpolity2", "lrgdpch2", "drgdpch2", "spline1", "spline2", "spline3", "openk2", "lopenk2", "dopenk2", "oil", "internet", "ethfrac", "relfrac", "warl", "onset"))
zvars.trade<-zvars.trade[complete.cases(zvars.trade),]
mnom.model <- zelig(mediascore ~ lopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
?factorize
zvars.trade$mediascore<-as.factor(zvars.trade$mediascore)
mnom.model <- zelig(mediascore ~ lopenk2 + scode + year,
model = "mlogit", data = zvars.trade)
summary(mnom.model)
devtools::install_github('IQSS/Zelig')
library("Zelig", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
detach("package:Zelig", unload=TRUE)
install.packages("Zelig")
library("Zelig", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
install.packages("Zelig", type = "both", repos = c("http://r.iq.harvard.edu/", "http://cran.stat.ucla.edu/"))
library("Zelig", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
